<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="RailsPresenter : The presentation layer you always wanted for your Rails applications">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>RailsPresenter</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/dfmonaco/rails_presenter">View on GitHub</a>

          <h1 id="project_title">RailsPresenter</h1>
          <h2 id="project_tagline">The presentation layer you always wanted for your Rails applications</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/dfmonaco/rails_presenter/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/dfmonaco/rails_presenter/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="railspresenter" class="anchor" href="#railspresenter" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>RailsPresenter</h1>

<p>RailsPresenter will help you to clean up your views and avoid helpers hell.</p>

<h2>
<a id="how-does-it-work" class="anchor" href="#how-does-it-work" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How does it work?</h2>

<p>Basically there are two main components, the <code>presenter object</code> and the <code>#present</code> helper method.</p>

<h3>
<a id="the-presenter-object" class="anchor" href="#the-presenter-object" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The presenter object</h3>

<p>You can think of a presenter as a mix between a domain model object and a view template, every method call not defined in the current class will be forwarded to the original domain model object, besides you can access all the view template functionality through the <code>#h</code> method. Also the <code>#target</code> (also aliased as <code>#object</code>) method will get you the unmodified original domain model object.</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">ProductPresenter<span class="pl-e"> &lt; RailsPresenter::Base</span></span>

  <span class="pl-k">def</span> <span class="pl-en">image</span>
    h.link_to(h.image_tag(<span class="pl-k">super</span>), h.product_path(target))
  <span class="pl-k">end</span>

<span class="pl-k">end</span></pre></div>

<h3>
<a id="the-present-helper-method" class="anchor" href="#the-present-helper-method" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The #present helper method</h3>

<p>The helper method <code>#present</code> it's used to instantiate new presenter objects, it takes any object, an array of objects or an ActiveRecord::Relation and returns the corresponding presenter instances.</p>

<div class="highlight highlight-source-ruby"><pre>present(<span class="pl-c1">Customer</span>.<span class="pl-k">new</span>).map(<span class="pl-k">&amp;</span><span class="pl-c1">:class</span>) <span class="pl-c"># =&gt; CustomerPresenter</span>
present([<span class="pl-c1">Customer</span>.<span class="pl-k">new</span>, <span class="pl-c1">Product</span>.<span class="pl-k">new</span>]).map(<span class="pl-k">&amp;</span><span class="pl-c1">:class</span>) <span class="pl-c"># =&gt; [CustomerPresenter, ProductPresenter]</span>
present(<span class="pl-c1">Product</span>.limit(<span class="pl-c1">2</span>).order(<span class="pl-c1">:name</span>))).map(<span class="pl-k">&amp;</span><span class="pl-c1">:class</span>) <span class="pl-c"># =&gt; [ProductPresenter, ProductPresenter]</span></pre></div>

<p>This method determines the name of the presenter class from the target object, for example a Project object would instantiate a ProjectPresenter object. If the assumed presenter class doesn't exist it will return the unmodified target object.</p>

<p>You can pass an optional block too, in fact this the intended usage of the helper in your views:</p>

<div class="highlight highlight-source-ruby"><pre>present(<span class="pl-smi">@purchase_order</span>) <span class="pl-k">do </span>|<span class="pl-smi">purchase_order_presenter</span>|
  purchase_order_presenter.date
  purchase_order_presenter.number
<span class="pl-k">end</span></pre></div>

<h2>
<a id="features" class="anchor" href="#features" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Features</h2>

<h3>
<a id="present-associations" class="anchor" href="#present-associations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Present associations</h3>

<p>Define the associated objects that you want to get automatically presented.</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">Post</span>
  has_many <span class="pl-c1">:comments</span>
  belongs_to <span class="pl-c1">:user</span>
<span class="pl-k">end</span>

<span class="pl-k">class</span> <span class="pl-en">PostPresenter<span class="pl-e"> &lt; RailsPresenter::Base</span></span>
  present <span class="pl-c1">:comments</span>, <span class="pl-c1">:user</span>
<span class="pl-k">end</span>

post_presenter <span class="pl-k">=</span> present(<span class="pl-c1">Post</span>.last)

post_presenter.comments.first.class <span class="pl-c"># =&gt; CommentPresenter</span>
post_presenter.user.class <span class="pl-c"># =&gt; UserPresenter</span></pre></div>

<h3>
<a id="use-super-at-will" class="anchor" href="#use-super-at-will" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Use <code>super</code> at will</h3>

<p>You can very easily add functionality on top of what RailsPresenter already provides, you just have to redefine your method and call <code>super</code>, class inheritance, module mixin, everything works as expected, as RailsPresenter uses a set of well identified (not anonymous) modules to extend functionality.</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-en">SupplierPresenter<span class="pl-e"> &lt; CompanyPresenter</span></span>; <span class="pl-k">end</span>
<span class="pl-k">class</span> <span class="pl-en">CompanyPresenter<span class="pl-e"> &lt; RailsPresenter::Base</span></span>; <span class="pl-k">end</span>

<span class="pl-c1">SupplierPresenter</span>.ancestors

<span class="pl-c"># =&gt;</span>

<span class="pl-c">#      [SupplierPresenter,</span>
<span class="pl-c">#       SupplierPresenter::NumberToCurrency,</span>
<span class="pl-c">#       SupplierPresenter::SupplierPresenterAssociations,</span>
<span class="pl-c">#       SupplierPresenter::BlankAttributes,</span>
<span class="pl-c">#       CompanyPresenter,</span>
<span class="pl-c">#       CompanyPresenter::BlankAttributes,</span>
<span class="pl-c">#       RailsPresenter::Base,</span>
<span class="pl-c">#       etc, etc...]</span></pre></div>

<h2>
<a id="are-you-crazy-we-already-have-draper" class="anchor" href="#are-you-crazy-we-already-have-draper" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Are you crazy? We already have Draper!!</h2>

<p>Well yes, Draper it's an amazing library and it inspired RailsPresenter in many ways (and was developed by people way more smarter than me), so I will try to illustrate what motivated me to reinvent the wheel.</p>

<p>At a basic level both provide the same functionality, but for my personal needs I find Draper too complex and with too many options, I prefer a simpler interface and good conventions, besides RailsPresenter implements a set of presentation related functionality on top of basic delegation as you can see on the aforementioned features. Additionally RailsPresenter it's meant to be used only inside the views, through the <code>#present</code> helper, so it doesn't provides any controller related functionality.</p>

<p>On the other side Draper has a much more fine-grained control over the methods delegated to the target object, RailsPresenter just will delegate every method called not defined in the presenter.</p>

<h3>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples:</h3>

<h4>
<a id="decorating-a-single-object" class="anchor" href="#decorating-a-single-object" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Decorating a single object</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># Draper way</span>

<span class="pl-c1">Article</span>.first.decorate
<span class="pl-c1">ArticleDecorator</span>.<span class="pl-k">new</span>(<span class="pl-c1">Article</span>.first)
<span class="pl-c1">ArticleDecorator</span>.decorate(<span class="pl-c1">Article</span>.first)

<span class="pl-c"># RailsPresenter way</span>

present(<span class="pl-c1">Article</span>.first)</pre></div>

<h4>
<a id="decorating-a-collection" class="anchor" href="#decorating-a-collection" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Decorating a collection</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># Draper way</span>

<span class="pl-c1">ArticleDecorator</span>.decorate_collection(<span class="pl-c1">Article</span>.all)
<span class="pl-c1">Article</span>.popular.decorate <span class="pl-c"># this only works for an ActiveRecord relation</span>
[<span class="pl-c1">Article</span>.first, <span class="pl-c1">Comment</span>.last, <span class="pl-c1">User</span>.find(<span class="pl-c1">3</span>)].decorate <span class="pl-c"># you can't do this</span>

<span class="pl-c"># RailsPresenter way</span>

present(<span class="pl-c1">Article</span>.all)
present(<span class="pl-c1">Article</span>.popular)
present([<span class="pl-c1">Article</span>.first, <span class="pl-c1">Comment</span>.last, <span class="pl-c1">User</span>.find(<span class="pl-c1">3</span>)]) <span class="pl-c"># you can decorate arbitrary arrays</span></pre></div>

<h4>
<a id="decorating-associations" class="anchor" href="#decorating-associations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Decorating associations</h4>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># Draper way</span>

<span class="pl-k">class</span> <span class="pl-en">Article<span class="pl-e"> &lt; ActiveRecord::Base</span></span>
  <span class="pl-c"># I think the following scope it's completely view related and doesn't belongs here</span>
  <span class="pl-k">def</span> <span class="pl-en">self.comments_with_author_included_and_ordered_by_created_at</span>
    comments.includes(<span class="pl-c1">:author</span>).order(<span class="pl-s"><span class="pl-pds">'</span>comments.created_at<span class="pl-pds">'</span></span>)
  <span class="pl-k">end</span>
<span class="pl-k">end</span>

<span class="pl-k">class</span> <span class="pl-en">ArticleDecorator<span class="pl-e"> &lt; Draper::Decorator</span></span>
  decorates_association <span class="pl-c1">:comments</span>, <span class="pl-c1">scope:</span> <span class="pl-c1">:comments_with_author_included_and_ordered_by_created_at</span>
<span class="pl-k">end</span>

<span class="pl-c"># RailsPresenter way</span>

<span class="pl-k">class</span> <span class="pl-en">ArticlePresenter<span class="pl-e"> &lt; RailsPresenter::Base</span></span>
  present <span class="pl-c1">:comments</span> <span class="pl-k">do</span>
    includes(<span class="pl-c1">:author</span>).order(<span class="pl-s"><span class="pl-pds">'</span>comments.created_at<span class="pl-pds">'</span></span>)
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>

<h2>
<a id="inspiration" class="anchor" href="#inspiration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Inspiration</h2>

<ul>
<li>Railscast: <a href="http://railscasts.com/episodes/287-presenters-from-scratch">http://railscasts.com/episodes/287-presenters-from-scratch</a>
</li>
<li>Book: <a href="http://pragprog.com/book/warv/the-rails-view">http://pragprog.com/book/warv/the-rails-view</a>
</li>
<li>Gem: <a href="https://github.com/drapergem/draper">https://github.com/drapergem/draper</a>
</li>
</ul>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<p>Add this line to your application's Gemfile:</p>

<pre><code>gem 'rails_presenter'
</code></pre>

<p>And then execute:</p>

<pre><code>$ bundle
</code></pre>

<p>Or install it yourself as:</p>

<pre><code>$ gem install rails_presenter
</code></pre>

<h2>
<a id="contributing" class="anchor" href="#contributing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contributing</h2>

<ol>
<li>Fork it</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create new Pull Request</li>
</ol>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h2>

<p><strong>MIT License</strong>. <em>Copyright 2013 Diego Mónaco</em></p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">RailsPresenter maintained by <a href="https://github.com/dfmonaco">dfmonaco</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-36994365-2");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
